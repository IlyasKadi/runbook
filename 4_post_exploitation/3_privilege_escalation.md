# 3_privilege_escalation

## Linux

### Manual enumeration

- Check for sensitive files in home directories.

```
find /home/ -name .bash_history 2> /dev/null
find /home/ -name .ssh 2> /dev/null
```

- Check for sensitive files in web server directory.

```
find /var/www/ -name "*config*.php"
find /var/www/ -name "initialize.php"
find /var/www/ -name "*.db"
which mysql
```

- Check for credentials in web server directory.

```shell
grep -r "DB_PASS" /var/www/
```

- Check for sensitive files in other directories.

```
/home
~
/
```

- Check group memberships.

```shell
id
```

- Check for files owned by a specific user

```shell
find / -user username 2> /dev/null
```

- Check the environment variables of the shell.

### Sudo & SUID

- Check for sudo permissions.

```shell
sudo -l
```

- Check for files that have SUID bits set.

```shell
find / -perm -u=s -type f -ls 2>/dev/null
```

### Cronjobs

```
crontab -l
cat /etc/crontab
```

### Capabilities

- Check for Linux capabilities

```shell
getcap -r / 2> /dev/null
```

### Networking

- Check socket statistics for processes exposed on the machine.

```
ss -s -l -n -t -u
```

### Kernel exploits

- Determine kernel version using `uname -a`.
- Search exploit databases for match.
- Run exploit.

### Automated tools

- LinPeas [GitHub](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)

## Windows

### Powershell history

The powershell history can be found at

```
$ENV:userprofile\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

### IIS configuration

IIS (Internet Information Services) is a web server software created by Microsoft for use with the Windows NT family.
The configuration of websites on IIS is stored in a file named `web.config` and can store credentials.
The file can be found at one of these locations

```
C:\inetpub\wwwroot\web.config
```
```
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config
```

### Saved windows credentials

Windows allows you to use other user's credentials. The command below will list the saved user credentials on the system.

```
cmdkey /list
```
You can try to use these by running

```
runas /savecred /user:username cmd.exe
```

### Putty credentials

You can retrieve the stored proxy credentials by running

```
reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\ /f "Proxy" /s
```

