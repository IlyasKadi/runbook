# privEsc

## Manual enumeration

- Check for sensitive files in home directories.

```
find /home/ -name .bash_history 2> /dev/null
find /home/ -name .ssh 2> /dev/null
```

- Check for sensitive files in web server directory.

```
find /var/www/ -name "*config*.php"
find /var/www/ -name "initialize.php"
find /var/www/ -name "*.db"
which mysql
```

- Check for credentials in web server directory.

```shell
grep -r "DB_PASS" /var/www/
```

- Check for sensitive files in other directories.

```
/home
~
/
```

- Check group memberships using `id`.
    - lxd => [https://github.com/lxc/distrobuilder](https://github.com/lxc/distrobuilder)
    - docker => `docker run -v /root:/mnt -it ubuntu`
    - disk => can read file system using `debugfs`
    - adm => can read logs in `/var/log`

- Check for files owned by a specific user

```shell
find / -user username 2> /dev/null
```

- Check the environment variables of the shell.

## Sudo & SUID

- Check for sudo permissions.

```shell
sudo -l
```

- Check for files that have SUID bits set.

```shell
find / -perm -u=s -type f -ls 2>/dev/null
```

## Cronjobs

```
crontab -l
cat /etc/crontab
```

## Capabilities

- Check for Linux capabilities

```shell
getcap -r / 2> /dev/null
```

## Networking

- Check socket statistics for processes exposed on the machine.

```
ss -s -l -n -t -u
```

- Check network interfaces for internal / unreachable networks.

## Kernel exploits

- Determine kernel version using `uname -a`.
- Search exploit databases for match.
- Run exploit.

## Automated tools

- LinPeas [GitHub](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS).
