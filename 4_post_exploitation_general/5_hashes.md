# 5_hashes

## Hash identification

- Determine the hash type using the following table.

| value | hashing algorithm |
|-------|-------------------|
| $1    | MD5               |
| $2    | Blowfish          |
| $5    | SHA-256           |
| $6    | SHA-512           |

- Determine the hash type using [https://hashes.com/en/tools/hash_identifier](https://hashes.com/en/tools/hash_identifier).
- Determine the hash type using [https://hashcat.net/wiki/doku.php?id=example_hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)

## Dumping hashes
- The hashes can be obtained from the `/etc/shadow` file.
- The hashes can be obtained from the metasploit `hashdump` command.

## Cracking hashes

- Crack hashes using John the ripper.

```shell
┌──(kali㉿kali)-[~]
└─$ cat hash   
admin:0d0ea5111e3c1def594c1684e3b9be84
r00t:f357a0c52799563c7c7b76c1e7543a32

┌──(kali㉿kali)-[~]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 hash
Using default input encoding: UTF-8
Loaded 2 password hashes with no different salts (Raw-MD5 [MD5 128/128 AVX 4x3])
Warning: no OpenMP support for this hash type, consider --fork=8
Press 'q' or Ctrl-C to abort, almost any other key for status
n100906          (r00t)     
mrsheafy         (admin)     
2g 0:00:00:00 DONE (2023-04-18 00:44) 7.142g/s 19086Kp/s 19086Kc/s 37816KC/s mrshollins..mrsgrandberry
Use the "--show --format=Raw-MD5" options to display all of the cracked passwords reliably
Session completed. 
```

- Crack linux password hashes using John the ripper.
```shell
john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt hash
```

- Crack windows password hashes using John the ripper.

```shell
john --wordlist=/usr/share/wordlists/rockyou.txt --format=NT hash
```

- Crack using Hashcat.

```shell
hashcat -m 1710 -a 0 hash /usr/share/wordlists/rockyou.txt
```
