# 6_pivoting

## Metasploit

- Route traffic through meterpreter sessions.
```shell
run autoroute -s 10.10.10.0/24
```

- Portforward to attacker machine.
```shell
portfwd add -l 1234 -p 80 -r $ip
```

- Ping sweep the internal network.

```shell
msf6 post(multi/gather/ping_sweep) > use ping_sweep
```

## Manual

- Ping sweep the internal network.

```shell
#!/bin/bash
for ip in $(seq 1 255); do
ping -c 1 10.200.57.$ip | grep "bytes from" | cut -d " " -f  4 | cut -d ":" -f  1 &
done
```

### SOCKS

- Start by dynamic port forwarding.

```shell
ssh -D 1234 user@$ip
```

- Next set up proxychains

```shell
sudo vim /etc/proxychains4.conf
# socks4 127.0.0.1 1234
```

- Portforward to attack machine.

```shell
ssh -L 1234:127.0.0.1:targetport user@$ip
```
